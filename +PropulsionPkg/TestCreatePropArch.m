function [Success] = TestCreatePropArch()
%
% [Success] = TestCreatePropArch()
% written by Paul Mokotoff, prmoko@umich.edu
% last updated: 08 may 2025
%
% Generate simple test cases to confirm that the propulsion architectures
% are being created properly. Assume all tests are for turboprop
% configurations unless otherwise specified in the section header(s).
%
% INPUTS:
%     none
%
% OUTPUTS:
%     Success - flag to show if all of the tests passed (1) or not (0).
%               size/type/units: 1-by-1 / int / []
%


%% TEST CASE SETUP %%
%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup testing methods      %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% relative tolerance for checking if the tests passed
EPS06 = 1.0e-06;

% assume all tests passed
Pass = ones(18, 1);

% count the tests
itest = 1;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup aircraft structure   %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% get the aircraft class
TestIn.Specs.TLAR.Class = "Turboprop";

% assume an electric motor/generator efficiency
EtaEM = 0.96;

% store the electric motor efficiency
TestIn.Specs.Power.Eta.EM = EtaEM;
TestIn.Specs.Power.Eta.EG = EtaEM;

% assume a propeller efficiency
EtaProp = 0.80;

% store the propeller efficiency
TestIn.Specs.Power.Eta.Propeller = EtaProp;

% assume a fan efficiency
EtaFan = 0.99;

% store the engine fan efficiency
TestIn.Specs.Propulsion.Engine.EtaPoly.Fan = 0.99;


%% CASE 1A: CONVENTIONAL, 2 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "C";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 2;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 0, 0, 0; ...
     0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0] ;

CorrectOperUps = ...
    [0, 1/2, 1/2, 0, 0, 0; ...
     0, 0  , 0  , 1, 0, 0; ...
     0, 0  , 0  , 0, 1, 0; ...
     0, 0  , 0  , 0, 0, 1; ...
     0, 0  , 0  , 0, 0, 1; ...
     0, 0  , 0  , 0, 0, 0];

CorrectOperDwn = ...
    [0, 0, 0, 0  , 0  , 0; ...
     1, 0, 0, 0  , 0  , 0; ...
     1, 0, 0, 0  , 0  , 0; ...
     0, 1, 0, 0  , 0  , 0; ...
     0, 0, 1, 0  , 0  , 0; ...
     0, 0, 0, 1/2, 1/2, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1      , 1      , 1; ...
     1, 1, 1, EtaProp, 1      , 1; ...
     1, 1, 1, 1      , EtaProp, 1; ...
     1, 1, 1, 1      , 1      , 1; ...
     1, 1, 1, 1      , 1      , 1; ...
     1, 1, 1, 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1      , 1      , 1, 1, 1; ...
     1, 1      , 1      , 1, 1, 1; ...
     1, 1      , 1      , 1, 1, 1; ...
     1, EtaProp, 1      , 1, 1, 1; ...
     1, 1      , EtaProp, 1, 1, 1; ...
     1, 1      , 1      , 1, 1, 1] ;
 
% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1          ;
CorrectTrnType = [1, 1, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 1B: CONVENTIONAL, 3 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "C";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0] ;

CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0] ;

CorrectOperDwn = ...
    [0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 1/3, 1/3, 1/3, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1, 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1      , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaProp, 1      , 1      , 1, 1, 1, 1; ...
     1, 1      , EtaProp, 1      , 1, 1, 1, 1; ...
     1, 1      , 1      , EtaProp, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1, 1, 1, 1] ;
 
% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                ;
CorrectTrnType = [1, 1, 1, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 1C: CONVENTIONAL, 3 ENGINES, TURBOFAN %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "C";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% set the aircraft class
TestIn.Specs.TLAR.Class = "Turbofan";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0] ;

CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0] ;

CorrectOperDwn = ...
    [0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 1/3, 1/3, 1/3, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, EtaFan, 1     , 1     , 1; ...
     1, 1, 1, 1, 1     , EtaFan, 1     , 1; ...
     1, 1, 1, 1, 1     , 1     , EtaFan, 1; ...
     1, 1, 1, 1, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1     , 1     , 1     , 1] ;
 
CorrectEtaDwn = ...
    [1, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaFan, 1     , 1     , 1, 1, 1, 1; ...
     1, 1     , EtaFan, 1     , 1, 1, 1, 1; ...
     1, 1     , 1     , EtaFan, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1, 1, 1, 1] ;
 
% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                ;
CorrectTrnType = [1, 1, 1, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 2A: ELECTRIC, 2 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "E";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 2;

% reset the aircraft class
TestIn.Specs.TLAR.Class = "Turboprop";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 0, 0, 0; ...
     0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0] ;

CorrectOperUps = ...
    [0, 1/2, 1/2, 0, 0, 0; ...
     0, 0  , 0  , 1, 0, 0; ...
     0, 0  , 0  , 0, 1, 0; ...
     0, 0  , 0  , 0, 0, 1; ...
     0, 0  , 0  , 0, 0, 1; ...
     0, 0  , 0  , 0, 0, 0];

CorrectOperDwn = ...
    [0, 0, 0, 0  , 0  , 0; ...
     1, 0, 0, 0  , 0  , 0; ...
     1, 0, 0, 0  , 0  , 0; ...
     0, 1, 0, 0  , 0  , 0; ...
     0, 0, 1, 0  , 0  , 0; ...
     0, 0, 0, 1/2, 1/2, 0] ;
 
CorrectEtaUps = ...
    [1, EtaEM, EtaEM, 1      , 1      , 1; ...
     1, 1    , 1    , EtaProp, 1      , 1; ...
     1, 1    , 1    , 1      , EtaProp, 1; ...
     1, 1    , 1    , 1      , 1      , 1; ...
     1, 1    , 1    , 1      , 1      , 1; ...
     1, 1    , 1    , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1    , 1      , 1      , 1, 1, 1; ...
     EtaEM, 1      , 1      , 1, 1, 1; ...
     EtaEM, 1      , 1      , 1, 1, 1; ...
     1    , EtaProp, 1      , 1, 1, 1; ...
     1    , 1      , EtaProp, 1, 1, 1; ...
     1    , 1      , 1      , 1, 1, 1] ;
 
% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  0          ;
CorrectTrnType = [0, 0, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 2B: ELECTRIC, 3 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "E";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0] ;

CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0] ;

CorrectOperDwn = ...
    [0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 1/3, 1/3, 1/3, 0] ;
 
CorrectEtaUps = ...
    [1, EtaEM, EtaEM, EtaEM, 1      , 1      , 1      , 1; ...
     1, 1    , 1    , 1    , EtaProp, 1      , 1      , 1; ...
     1, 1    , 1    , 1    , 1      , EtaProp, 1      , 1; ...
     1, 1    , 1    , 1    , 1      , 1      , EtaProp, 1; ...
     1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1    , 1    , 1    , 1      , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     EtaEM, 1      , 1      , 1      , 1, 1, 1, 1; ...
     EtaEM, 1      , 1      , 1      , 1, 1, 1, 1; ...
     EtaEM, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1    , EtaProp, 1      , 1      , 1, 1, 1, 1; ...
     1    , 1      , EtaProp, 1      , 1, 1, 1, 1; ...
     1    , 1      , 1      , EtaProp, 1, 1, 1, 1; ...
     1    , 1      , 1      , 1      , 1, 1, 1, 1] ;
 
% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  0                ;
CorrectTrnType = [0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 2C: ELECTRIC, 3 ENGINES, TURBOFAN %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "E";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% change the aircraft class
TestIn.Specs.TLAR.Class = "Turbofan";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0] ;

CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0] ;

CorrectOperDwn = ...
    [0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 1/3, 1/3, 1/3, 0] ;
 
CorrectEtaUps = ...
    [1, EtaEM, EtaEM, EtaEM, 1     , 1     , 1     , 1; ...
     1, 1    , 1    , 1    , EtaFan, 1     , 1     , 1; ...
     1, 1    , 1    , 1    , 1     , EtaFan, 1     , 1; ...
     1, 1    , 1    , 1    , 1     , 1     , EtaFan, 1; ...
     1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1    , 1    , 1    , 1     , 1     , 1     , 1] ;
 
CorrectEtaDwn = ...
    [1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     EtaEM, 1     , 1     , 1     , 1, 1, 1, 1; ...
     EtaEM, 1     , 1     , 1     , 1, 1, 1, 1; ...
     EtaEM, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1    , EtaFan, 1     , 1     , 1, 1, 1, 1; ...
     1    , 1     , EtaFan, 1     , 1, 1, 1, 1; ...
     1    , 1     , 1     , EtaFan, 1, 1, 1, 1; ...
     1    , 1     , 1     , 1     , 1, 1, 1, 1] ;
 
% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  0                ;
CorrectTrnType = [0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 3A: PARALLEL HYBRID, 2 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "PHE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 2;

% reset the aircraft class
TestIn.Specs.TLAR.Class = "Turboprop";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% define an arbitrary power split
Lambda = 0.07;

% remember the correct matrices
CorrectArch = ...
    [0, 0, 1, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0] ;
 
CorrectOperUps = ...
    [0, 0, 1/2, 1/2, 0  , 0  , 0, 0, 0; ...
     0, 0, 0  , 0  , 1/2, 1/2, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0       , 0       , 0     , 0     , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 0     , 0     , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0     , 0     , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0     , 0     , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0     , 0     , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0     , 0     , 0  , 0  , 0; ...
     0, 0, 1-Lambda, 0       , Lambda, 0     , 0  , 0  , 0; ...
     0, 0, 0       , 1-Lambda, 0     , Lambda, 0  , 0  , 0; ...
     0, 0, 0       , 0       , 0     , 0     , 1/2, 1/2, 0];
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, EtaEM, EtaEM, 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1    , 1    , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1      , 1      , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1, 1, 1; ...
     1, EtaEM, 1      , 1      , 1      , 1      , 1, 1, 1; ...
     1, EtaEM, 1      , 1      , 1      , 1      , 1, 1, 1; ...
     1, 1    , EtaProp, 1      , EtaProp, 1      , 1, 1, 1; ...
     1, 1    , 1      , EtaProp, 1      , EtaProp, 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(     1), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType = [1, 0            ];
CorrectTrnType = [1, 1, 0, 0, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 3B: PARALLEL HYBRID, 3 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "PHE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
 
CorrectOperUps = ...
    [0, 0, 1/3, 1/3, 1/3, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 0, 1-Lambda, 0       , 0       , Lambda, 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 0, 0       , 1-Lambda, 0       , 0     , Lambda, 0     , 0  , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 1-Lambda, 0     , 0     , Lambda, 0  , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 0       , 0     , 0     , 0     , 1/3, 1/3, 1/3, 0];
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, EtaEM, EtaEM, EtaEM, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1      , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , EtaProp, 1      , 1      , EtaProp, 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1      , EtaProp, 1      , 1      , EtaProp, 1      , 1, 1, 1, 1; ...
     1, 1    , 1      , 1      , EtaProp, 1      , 1      , EtaProp, 1, 1, 1, 1; ...
     1, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(     1), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType = [1, 0                     ];
CorrectTrnType = [1, 1, 1, 0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 3C: PARALLEL HYBRID, 3 ENGINES, TURBOFAN %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "PHE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% change the aircraft class
TestIn.Specs.TLAR.Class = "Turbofan";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
 
CorrectOperUps = ...
    [0, 0, 1/3, 1/3, 1/3, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0  , 0  , 0  , 0, 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     1, 0, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 1, 0       , 0       , 0       , 0     , 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 0, 1-Lambda, 0       , 0       , Lambda, 0     , 0     , 0  , 0  , 0  , 0; ...
     0, 0, 0       , 1-Lambda, 0       , 0     , Lambda, 0     , 0  , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 1-Lambda, 0     , 0     , Lambda, 0  , 0  , 0  , 0; ...
     0, 0, 0       , 0       , 0       , 0     , 0     , 0     , 1/3, 1/3, 1/3, 0];
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, EtaEM, EtaEM, EtaEM, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaFan, 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , EtaFan, 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , EtaFan, 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaFan, 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , EtaFan, 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , EtaFan, 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1     , 1     , 1     , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , EtaFan, 1     , 1     , EtaFan, 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1     , EtaFan, 1     , 1     , EtaFan, 1     , 1, 1, 1, 1; ...
     1, 1    , 1     , 1     , EtaFan, 1     , 1     , EtaFan, 1, 1, 1, 1; ...
     1, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(     1), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType = [1, 0                     ];
CorrectTrnType = [1, 1, 1, 0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 4A: SERIES HYBRID, 2 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "SHE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 2;

% reset the aircraft class
TestIn.Specs.TLAR.Class = "Turboprop";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% define an arbitrary power split
Lambda = 0.07;

% remember the correct matrices
CorrectArch = ...
    [0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 0, 1/2, 1/2, 0, 0, 0  , 0  , 0, 0, 0; ...
     0, 0, 0  , 0  , 0, 0, 1/2, 1/2, 0, 0, 0; ...
     0, 0, 0  , 0  , 1, 0, 0  , 0  , 0, 0, 0; ...
     0, 0, 0  , 0  , 0, 1, 0  , 0  , 0, 0, 0; ...
     0, 0, 0  , 0  , 0, 0, 1  , 0  , 0, 0, 0; ...
     0, 0, 0  , 0  , 0, 0, 0  , 1  , 0, 0, 0; ...
     0, 0, 0  , 0  , 0, 0, 0  , 0  , 1, 0, 0; ...
     0, 0, 0  , 0  , 0, 0, 0  , 0  , 0, 1, 0; ...
     0, 0, 0  , 0  , 0, 0, 0  , 0  , 0, 0, 1; ...
     0, 0, 0  , 0  , 0, 0, 0  , 0  , 0, 0, 1; ...
     0, 0, 0  , 0  , 0, 0, 0  , 0  , 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0     , 0, 0, 0       , 0       , 0, 0, 0  , 0  , 0; ...
     0, 0     , 0, 0, 0       , 0       , 0, 0, 0  , 0  , 0; ...
     1, 0     , 0, 0, 0       , 0       , 0, 0, 0  , 0  , 0; ...
     1, 0     , 0, 0, 0       , 0       , 0, 0, 0  , 0  , 0; ...
     0, 0     , 1, 0, 0       , 0       , 0, 0, 0  , 0  , 0; ...
     0, 0     , 0, 1, 0       , 0       , 0, 0, 0  , 0  , 0; ...
     0, Lambda, 0, 0, 1-Lambda, 0       , 0, 0, 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0       , 1-Lambda, 0, 0, 0  , 0  , 0; ...
     0, 0     , 0, 0, 0       , 0       , 1, 0, 0  , 0  , 0; ...
     0, 0     , 0, 0, 0       , 0       , 0, 1, 0  , 0  , 0; ...
     0, 0     , 0, 0, 0       , 0       , 0, 0, 1/2, 1/2, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaEM, EtaEM, 1      , 1      , 1; ...
     1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , EtaEM, 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , EtaEM, 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, EtaEM, 1    , 1    , EtaEM, 1    , 1      , 1      , 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , EtaEM, 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , EtaProp, 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1      , EtaProp, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(      ), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType = [1, 0                  ];
CorrectTrnType = [1, 1, 3, 3, 0, 0, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 4B: SERIES HYBRID, 3 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "SHE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 1, 0, 0, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 1, 0, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 1, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 1  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 1  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 1  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 1, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 1, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 1, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0, 1-Lambda, 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0, 0       , 1-Lambda, 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0, 0       , 0       , 1-Lambda, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 1/3, 1/3, 1/3, 0];
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaEM, EtaEM, EtaEM, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1] ;
 
 CorrectEtaDwn = ...
    [1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , EtaEM, 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1    , EtaEM, 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1    , 1    , EtaEM, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , EtaProp, 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , EtaProp, 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , EtaProp, 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1];

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(      ), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType = [1, 0                              ];
CorrectTrnType = [1, 1, 1, 3, 3, 3, 0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 4C: SERIES HYBRID, 3 ENGINES, TURBOFAN %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "SHE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% change the aircraft class
TestIn.Specs.TLAR.Class = "Turbofan";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 1/3, 1/3, 1/3, 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 1, 0, 0, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 1, 0, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 1, 0  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 1  , 0  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 1  , 0  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 1  , 0, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 1, 0, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 1, 0, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 1, 0; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 1; ...
     0, 0, 0  , 0  , 0  , 0, 0, 0, 0  , 0  , 0  , 0, 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 1, 0, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 1, 0, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 1, 0       , 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0, 1-Lambda, 0       , 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0, 0       , 1-Lambda, 0       , 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, Lambda, 0, 0, 0, 0       , 0       , 1-Lambda, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0     , 0, 0, 0, 0       , 0       , 0       , 0, 0, 0, 1/3, 1/3, 1/3, 0];
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaEM, EtaEM, EtaEM, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , EtaFan, 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , EtaFan, 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , EtaFan, 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1] ;
 
 CorrectEtaDwn = ...
    [1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , EtaEM, 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1    , EtaEM, 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1    , 1    , EtaEM, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , EtaFan, 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , EtaFan, 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , EtaFan, 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1];

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(      ), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType = [1, 0                              ];
CorrectTrnType = [1, 1, 1, 3, 3, 3, 0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 5A: TURBOELECTRIC, 2 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "TE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 2;

% reset the aircraft class
TestIn.Specs.TLAR.Class = "Turboprop";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 1/2, 1/2, 0, 0, 0  , 0  , 0, 0, 0; ...
     0, 0  , 0  , 1, 0, 0  , 0  , 0, 0, 0; ...
     0, 0  , 0  , 0, 1, 0  , 0  , 0, 0, 0; ...
     0, 0  , 0  , 0, 0, 1  , 0  , 0, 0, 0; ...
     0, 0  , 0  , 0, 0, 0  , 1  , 0, 0, 0; ...
     0, 0  , 0  , 0, 0, 0  , 0  , 1, 0, 0; ...
     0, 0  , 0  , 0, 0, 0  , 0  , 0, 1, 0; ...
     0, 0  , 0  , 0, 0, 0  , 0  , 0, 0, 1; ...
     0, 0  , 0  , 0, 0, 0  , 0  , 0, 0, 1; ...
     0, 0  , 0  , 0, 0, 0  , 0  , 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0  , 0  , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0  , 0  , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0  , 0  , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0  , 0  , 0; ...
     0, 0, 0, 0, 1, 0, 0, 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 1, 0, 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 1, 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 1/2, 1/2, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, EtaEM, 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1    , EtaEM, 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , EtaEM, 1    , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , EtaEM, 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , EtaProp, 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , EtaProp, 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , EtaEM, 1    , 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , EtaEM, 1    , 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , EtaEM, 1      , 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , EtaProp, 1      , 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1      , EtaProp, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1      , 1      , 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                      ;
CorrectTrnType = [1, 1, 3, 3, 0, 0, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 5B: TURBOELECTRIC, 3 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "TE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct architecture matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 1/3, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1      , 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , EtaProp, 1      , 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , EtaProp, 1      , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , EtaProp, 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                                  ;
CorrectTrnType = [1, 1, 1, 3, 3, 3, 0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 5C: TURBOELECTRIC, 3 ENGINES, TURBOFAN %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "TE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% change the aircraft class
TestIn.Specs.TLAR.Class = "Turbofan";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% remember the correct architecture matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0  , 0  , 0  , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0  , 0  , 0  , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/3, 1/3, 1/3, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , EtaFan, 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , EtaFan, 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , EtaFan, 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1] ;
 
CorrectEtaDwn = ...
    [1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1     , 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , EtaFan, 1     , 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , EtaFan, 1     , 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , EtaFan, 1, 1, 1, 1; ...
     1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch     , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps   , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn   , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                                  ;
CorrectTrnType = [1, 1, 1, 3, 3, 3, 0, 0, 0, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 6A: PARTIALLY TURBOELECTRIC, 2 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "PE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 2;

% reset the aircraft class
TestIn.Specs.TLAR.Class = "Turboprop";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% define an arbitrary power split
Lambda = 0.07;

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 1/2, 1/2, 0       , 0       , 0, 0, 0, 0, 0     , 0     , 0; ...
     0, 0  , 0  , 1-Lambda, 0       , 0, 0, 0, 0, Lambda, 0     , 0; ...
     0, 0  , 0  , 0       , 1-Lambda, 0, 0, 0, 0, 0     , Lambda, 0; ...
     0, 0  , 0  , 0       , 0       , 1, 0, 0, 0, 0     , 0     , 0; ...
     0, 0  , 0  , 0       , 0       , 0, 1, 0, 0, 0     , 0     , 0; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 1, 0, 0     , 0     , 0; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 0, 1, 0     , 0     , 0; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 0, 0, 0     , 0     , 1; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 0, 0, 0     , 0     , 1; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 0, 0, 0     , 0     , 1; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 0, 0, 0     , 0     , 1; ...
     0, 0  , 0  , 0       , 0       , 0, 0, 0, 0, 0     , 0     , 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 0, 0, 1, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 1, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 1, 0           , 0           , 0       , 0       , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0           , 0           , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, (1-Lambda)/2, (1-Lambda)/2, Lambda/2, Lambda/2, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, EtaEM, 1    , 1    , 1    , 1      , 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1    , EtaEM, 1    , 1    , 1      , 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1    , 1    , EtaEM, 1    , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , EtaEM, 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , EtaProp, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1      , 1      , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, EtaEM  , 1      , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , EtaEM  , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , EtaEM, 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1    , EtaEM, 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1    , 1    , EtaProp, 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1    , 1    , 1      , EtaProp, 1, 1, 1, 1, 1; ...
     1, EtaProp, 1      , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , EtaProp, 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1    , 1    , 1      , 1      , 1, 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(Lambda), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                            ;
CorrectTrnType = [1, 1, 3, 3, 0, 0, 2, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 6B: PARTIALLY TURBOELECTRIC, 3 ENGINES %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "PE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% define an arbitrary power split
Lambda = 0.07;

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 1-Lambda, 0       , 0       , 0, 0, 0, 0, 0, 0, Lambda, 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 1-Lambda, 0       , 0, 0, 0, 0, 0, 0, 0     , Lambda, 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 1-Lambda, 0, 0, 0, 0, 0, 0, 0     , 0     , Lambda, 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 1, 0, 0, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 1, 0, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 1, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 1, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 1, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 1, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (1-Lambda)/3, (1-Lambda)/3, (1-Lambda)/3, Lambda/3, Lambda/3, Lambda/3, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , EtaProp, 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , EtaProp, 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , EtaProp, 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , EtaProp, 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , EtaProp, 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , EtaProp, 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1      , 1      , 1      , 1      , 1      , 1      , 1] ;
 
CorrectEtaDwn = ...
    [1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, EtaEM  , 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , EtaEM  , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , EtaEM  , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , EtaEM, 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , EtaEM, 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , EtaEM, 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , EtaProp, 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , EtaProp, 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , 1      , EtaProp, 1, 1, 1, 1, 1, 1, 1; ...
     1, EtaProp, 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , EtaProp, 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , EtaProp, 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1      , 1      , 1      , 1    , 1    , 1    , 1      , 1      , 1      , 1, 1, 1, 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(Lambda), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                                           ;
CorrectTrnType = [1, 1, 1, 3, 3, 3, 0, 0, 0, 2, 2, 2, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end

% increment the test number
itest = itest + 1;


%% CASE 6C: PARTIALLY TURBOELECTRIC, 3 ENGINES, TURBOFAN %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% setup the inputs           %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% set the architecture
TestIn.Specs.Propulsion.PropArch.Type = "PE";

% set the number of engines
TestIn.Specs.Propulsion.NumEngines = 3;

% change the aircraft class
TestIn.Specs.TLAR.Class = "Turbofan";

% ----------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                            %
% run the test               %
%                            %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% create the propulsion architecture
TestOut = PropulsionPkg.CreatePropArch(TestIn);

% define an arbitrary power split
Lambda = 0.07;

% remember the correct matrices
CorrectArch = ...
    [0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0] ;
     
CorrectOperUps = ...
    [0, 1/3, 1/3, 1/3, 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 1-Lambda, 0       , 0       , 0, 0, 0, 0, 0, 0, Lambda, 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 1-Lambda, 0       , 0, 0, 0, 0, 0, 0, 0     , Lambda, 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 1-Lambda, 0, 0, 0, 0, 0, 0, 0     , 0     , Lambda, 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 1, 0, 0, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 1, 0, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 1, 0, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 1, 0, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 1, 0, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 1, 0     , 0     , 0     , 0; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 1; ...
     0, 0  , 0  , 0  , 0       , 0       , 0       , 0, 0, 0, 0, 0, 0, 0     , 0     , 0     , 0] ;
 
CorrectOperDwn = ...
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0           , 0           , 0           , 0       , 0       , 0       , 0; ...
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, (1-Lambda)/3, (1-Lambda)/3, (1-Lambda)/3, Lambda/3, Lambda/3, Lambda/3, 0] ;
 
CorrectEtaUps = ...
    [1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, EtaEM, 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , EtaFan, 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , EtaEM, 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , EtaFan, 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , EtaEM, 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , EtaFan, 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , EtaEM, 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , EtaEM, 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , EtaEM, 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , EtaFan, 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , EtaFan, 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , EtaFan, 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1; ...
     1, 1, 1, 1, 1    , 1    , 1    , 1    , 1    , 1    , 1     , 1     , 1     , 1     , 1     , 1     , 1] ;
 
CorrectEtaDwn = ...
    [1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, EtaEM , 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , EtaEM , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , EtaEM , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , EtaEM, 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , EtaEM, 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , EtaEM, 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , EtaFan, 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , EtaFan, 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , 1     , EtaFan, 1, 1, 1, 1, 1, 1, 1; ...
     1, EtaFan, 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , EtaFan, 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , EtaFan, 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1; ...
     1, 1     , 1     , 1     , 1    , 1    , 1    , 1     , 1     , 1     , 1, 1, 1, 1, 1, 1, 1] ;

% check the matrices
FooPass(1) = CheckTest(TestOut.Specs.Propulsion.PropArch.Arch           , CorrectArch   , EPS06);
FooPass(2) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperDwn(Lambda), CorrectOperDwn, EPS06);
FooPass(3) = CheckTest(TestOut.Specs.Propulsion.PropArch.OperUps(Lambda), CorrectOperUps, EPS06);
FooPass(4) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaUps         , CorrectEtaUps , EPS06);
FooPass(5) = CheckTest(TestOut.Specs.Propulsion.PropArch.EtaDwn         , CorrectEtaDwn , EPS06);

% correct source and transmitter types
CorrectSrcType =  1                                           ;
CorrectTrnType = [1, 1, 1, 3, 3, 3, 0, 0, 0, 2, 2, 2, 2, 2, 2];

% check the energy and power source types
FooPass(6) = CheckTest(TestOut.Specs.Propulsion.PropArch.SrcType, CorrectSrcType, EPS06);
FooPass(7) = CheckTest(TestOut.Specs.Propulsion.PropArch.TrnType, CorrectTrnType, EPS06);

% check that all tests passed
if (any(~FooPass))
    
    % one or more of the tests failed
    Pass(itest) = 0;
    
else
    
    % all tests passed
    Pass(itest) = 1;
    
end


%% CHECK THE TEST RESULTS %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% identify any tests that failed
itest = find(~Pass);

% check whether any tests failed
if (isempty(itest))
    
    % all tests passed
    fprintf(1, "CreatePropArch tests passed!\n");
    
    % return success
    Success = 1;
    
else
    
    % print out header
    fprintf(1, "CreatePropArch tests failed:\n");
    
    % print which tests failed
    fprintf(1, "    Test %d\n", itest);
    
    % return failure
    Success = 0;
    
end

% ----------------------------------------------------------

end

% ----------------------------------------------------------
% ----------------------------------------------------------
% ----------------------------------------------------------

function [Pass] = CheckTest(TestValue, TrueValue, Tol)
%
% [Pass] = CheckTest(TestValue, TrueValue, Tol)
% written by Paul Mokotoff, prmoko@umich.edu
% last updated: 08 may 2025
%
% Helper function to check if a test passed.
%
% INPUTS:
%     TestValue - array of the returned values from the function.
%                 size/type/units: m-by-n / double / []
%
%     TrueValue - array of the expected values output from the function.
%                 size/type/units: m-by-n / double / []
%
%     Tol       - acceptable relative tolerance between the test and true
%                 values.
%                 size/type/units: 1-by-1 / double / []
%
% OUTPUTS:
%     Pass      - flag to show whether the test passed (1) or not (0)
%

% compute the relative tolerance
AbsTol = abs(TestValue - TrueValue);

% check the tolerance
if (any(AbsTol > Tol, "all"))
    
    % the test fails
    Pass = 0;
    
else
    
    % the test passes
    Pass = 1;
    
end

% ----------------------------------------------------------

end