clear; clc; close all;

% % https://supstl.com/products/schedule-40-pipe/
% % medium thickness pipe schedule. good for initial 
% data = [0.13	0.405	0.269	0.068	0.085
% 0.25	0.54	0.364	0.088	0.147
% 0.38	0.675	0.493	0.091	0.196
% 0.50	0.84	0.622	0.109	0.294
% 0.75	1.05	0.824	0.113	0.391
% 1.00	1.315	1.049	0.133	0.581
% 1.25	1.66	1.38	0.14	0.786
% 1.50	1.9	1.61	0.145	0.94
% 2.00	2.375	2.067	0.154	1.26
% 2.50	2.875	2.469	0.203	2
% 3.00	3.5	3.068	0.216	2.62
% 3.50	4	3.548	0.226	3.15
% 4.00	4.5	4.026	0.237	3.73
% 5.00	5.563	5.047	0.258	5.06
% 6.00	6.625	6.065	0.28	6.56
% 8.00	8.625	7.981	0.322	9.88
% 10.00	10.75	10.02	0.365	14
% 12.00	12.75	12	0.375	17.14
% ];
% 
% 
% ID = data(:,3);
% Thick = data(:,4);
% 
% 
% scatter(ID,Thick,'b')
% grid on
% 
% model = fitlm(ID,Thick,'quadratic')
% 
% % p2 = [-0.0019092 0.047634 0.074449]
% 
% p2 = [0.03 0.074449]
% 
% fitted = polyval(p2, linspace(0,15,100))
% 
% hold on
% plot(linspace(0,15,100), fitted,'b')
% 




% alcobradata = [
% 0.13 0.04 0.06  0.0115
% 0.19 0.05 0.09  0.0252
% 0.25 0.08 0.08  0.0522
% 0.31 0.1 0.12    0.0788
% 0.38 0.1 0.19   0.0983
% 0.44 0.12 0.2   0.1453
% 0.5 0.13 0.25   0.1732
% 0.56 0.13 0.31  0.2084
% 0.63 0.16 0.31  0.2703
% 0.75 0.05 0.65  0.1269
% 0.75 0.19 0.37  0.0423
% 0.88 0.19 0.5   0.4918
% 1 0.25 0.5  0.7139
% 1.13 0.25 0.63  0.8082
% 1.25 0.31 0.62  1.08
% 1.38 0.38 0.88  1.39
% 1.5 0.38 1.25  1.5590
% 1.63 0.31 1  1.5170
% 1.75 0.38 1.65  1.9050
% 1.88 0.38 1.13  2.08
% 2 0.5 1  2.7710
% 2.13 0.22 1.68  1.5670
% 2.25 0.5 1.25  3.2330
% 2.38 0.38 1.63  2.7710
% 2.5 0.75 1  4.8490
% 2.63 0.07 2.5  0.6148
% 2.75 0.75 1.25  5.5420
% 2.88 0.38 2.13  3.5700
% 3 1 1  7.3890
% 3.25 0.75 1.75  6.93
% 3.5 1.000 1.5  9.2370
% 3.75 1.125 1.5  10.9100
% 4 1.000 2  11.0800
% 4.13 0.375 3.38  5.1950
% 4.25 1.000 2.25  12.0100
% 4.38 0.080 4.22  1.2690
% 4.5 1.000 2.5  12.9300 
% 4.75 0.750 3.25  11.4200
% 5 1.125 2.75  16.1100
% 5.25 1.000 3.25  15.7000
% 5.5 1.000 3.5  16.6300
% 6 1.250 3.5  21.9400
% 6.25 0.500 5.25  10.62
% 6.5 1 4.5  20.3200
% 6.63 0.43 5.76  9.88
% 6.75 0.75 5.25  16.62
% 7 1.5 4  30.4800
% 7.5 1 5.5  24.0100
% 8 1 6  25.8600
% 8.25 0.13 8  3.75
% 8.5 1 6.5  27.71
% 8.63 0.5 7.63  15.01
% 9 2 5  51.72
% 9.5 0.75 8  24.25
% 10 1 8  33.25
% 10.25 0.13 10  4.68
% 10.5 0.5 9.5  18.47
% 10.75 1 8.75  36.02
% 11 2 7  66.5
% 12 2 8  73.89
% 12.75 1 10.75  43.41
% ];
% 
% ALID = alcobradata(:,3);
% ALT = alcobradata(:,2);
% 
% scatter(ALID,ALT,'r')
% 
% plot([0 15],[0 6],'r')





% Chicago tube and iron pipe schedules
CTI = [
40 .405 .269 .068 .085 
80 .405 .215 .095 .109
40 .540 .364 .088 .147 
80 .540 .302 .119 .185
40 .675 .493 .091 .196 
80 .675 .423 .126 .256
5 .840 .710 .065 .186 
10 .840 .674 .083 .232 
40 .840 .622 .109 .294 
80 .840 .546 .147 .376 
160 .840 .464 .188 .453
5 1.050 .920 .065 .237 
10 1.050 .884 .083 .297 
40 1.050 .824 .113 .391 
80 1.050 .742 .154 .510 
160 1.050 .612 .219 .672
5 1.315 1.185 .065 .300 
10 1.315 1.097 .109 .486 
40 1.315 1.049 .133 .581 
80 1.315 .957 .179 .751 
160 1.315 .815 .250 .984
5 1.660 1.530 .065 .383 
10 1.660 1.442 .109 .625 
40 1.660 1.380 .140 .786 
80 1.660 1.278 .191 1.037 
160 1.660 1.160 .250 1.302
5 1.900 1.770 .065 .441 
10 1.900 1.682 .109 .721 
40 1.900 1.610 .145 .940 
80 1.900 1.500 .200 1.256 
160 1.900 1.338 .281 1.681
5 2.375 2.245 .065 .555 
10 2.375 2.157 .109 .913 
40 2.375 2.067 .154 1.264 
80 2.375 1.939 .218 1.737 
160 2.375 1.687 .344 2.581
5 2.875 2.709 .083 .856 
10 2.875 2.635 .120 1.221 
40 2.875 2.469 .203 2.004 
80 2.875 2.323 .276 2.650 
160 2.875 2.125 .375 3.464
5 3.500 3.334 .083 1.048 
10 3.500 3.260 .120 1.498 
40 3.500 3.068 .216 2.621 
80 3.500 2.900 .300 3.547 
160 3.500 2.624 .438 4.955
5 4.000 3.834 .083 1.201 
10 4.000 3.706 .120 1.720 
40 4.000 3.548 .226 3.151 
80 4.000 3.364 .318 4.326
5 4.500 4.334 .083 1.354 
10 4.500 4.260 .120 1.942 
40 4.500 4.026 .237 3.733 
80 4.500 3.826 .337 5.183 
120 4.500 3.624 .438 6.573 
160 4.500 3.438 .531 7.786
5 5.563 5.345 .109 2.196 
10 5.563 5.295 .134 2.688 
40 5.563 5.047 .258 5.057 
80 5.563 4.813 .375 7.188 
120 5.563 4.563 .500 9.353 
160 5.563 4.313 .625 11.400
5 6.625 6.407 .109 2.624 
10 6.625 6.357 .134 3.213 
40 6.625 6.065 .280 6.564 
80 6.625 5.761 .432 9.884 
120 6.625 5.501 .562 12.950 
160 6.625 5.189 .719 15.690
5 8.625 8.407 .109 3.429 
10 8.625 8.329 .148 4.635 
20 8.625 8.125 .250 7.735 
30 8.625 8.071 .277 8.543 
40 8.625 7.981 .322 9.878 
60 8.625 7.813 .406 12.330 
80 8.625 7.625 .500 15.010 
100 8.625 7.437 .594 17.620 
120 8.625 7.187 .719 21.000 
140 8.625 7.001 .812 23.440 
160 8.625 6.813 .906 25.840
5 10.750 10.482 .134 5.256 
10 10.750 10.420 .165 6.453 
20 10.750 10.250 .250 9.698 
30 10.750 10.136 .307 11.840 
40 10.750 10.020 .365 14.000 
60 10.750 9.750 .500 18.930 
80 10.750 9.562 .594 22.290 
100 10.750 9.312 .719 26.650
5 12.750 12.438 .156 7.258 
10 12.750 12.390 .180 8.359 
20 12.750 12.250 .250 11.550 
30 12.750 12.090 .330 15.140 
40 12.750 11.938 .406 18.520 
60 12.750 11.626 .562 25.310 
80 12.750 11.374 .688 30.660
];

CTI(:,[2:4]) = CTI(:,[2:4]) * 0.0254;

Mat.S5 = CTI(CTI(:,1) == 5,:);
Mat.S10 = CTI(CTI(:,1) == 10,:);
Mat.S20 = CTI(CTI(:,1) == 20,:);
Mat.S30 = CTI(CTI(:,1) == 30,:);
Mat.S40 = CTI(CTI(:,1) == 40,:);
Mat.S60 = CTI(CTI(:,1) == 60,:);
Mat.S80 = CTI(CTI(:,1) == 80,:);
Mat.S100 = CTI(CTI(:,1) == 100,:);
Mat.S120 = CTI(CTI(:,1) == 120,:);
Mat.S140 = CTI(CTI(:,1) == 140,:);
Mat.S160 = CTI(CTI(:,1) == 160,:);

figure(1)
ldg = [];


for ii = [5 10 20 30 40 60 80 100 120 140 160]

    name = "S" + num2str(ii);
    ldg = [ldg,name];

    data = Mat.(name);

    plot(data(:,3),data(:,4))

    hold on

  
end
grid on
legend(ldg)
xlabel('Pipe Inner Diameter (m)')
ylabel('Pipe Thickness (m)')


figure(2)

data = Mat.S80

fitlm(data(:,3),data(:,4))

p1 = [0.050881 0.0031385];

IDs = linspace(0,12 * 0.026);
Ts = polyval(p1,IDs);

scatter(data(:,3),data(:,4),'b')
hold on
plot(IDs,Ts,'k')
grid on

xlabel('Pipe Inner Diameter (m)')
ylabel('Pipe Thickness (m)')
legend("Raw Schedule 80 Data","Linear Fit",'location','best')













